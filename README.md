# Unity SRP 기반 실시간 하이브리드 워터마킹 성능 및 화질 분석

## 프로젝트 개요

본 프로젝트는 Unity Universal Render Pipeline (URP) 환경에서 실시간 디지털 워터마킹 기법의 성능 및 화질 영향을 분석하기 위해 개발되었습니다. 디지털 콘텐츠의 지적 재산권 보호 및 무단 복제 방지의 중요성이 커짐에 따라, 게임과 같은 실시간 상호작용형 콘텐츠에 효과적인 워터마킹 기술을 적용하는 방안을 탐구합니다.

## 연구 목표

* Unity URP 환경의 최종 렌더링 단계에 LSB (Least Significant Bit), DCT (Discrete Cosine Transform), DWT (Discrete Wavelet Transform) 기반 워터마킹 기법을 통합.
* 컴퓨트 셰이더를 활용하여 GPU 상에서 실시간 워터마크 삽입 연산 수행.
* 워터마크 적용 빈도(매 프레임 및 간헐적 적용) 및 워터마킹 강도가 렌더링 성능(프레임률, CPU/GPU 부하) 및 이미지 화질(PSNR, SSIM, MSE)에 미치는 영향 정량적으로 분석.
* 연산 부하와 시각적 충실도 간의 균형을 이루는 실시간 워터마킹 적용을 위한 기초 자료 제시.

## 기술 스택

* **게임 엔진:** Unity 2022.3.60f1 [cite: 93]
* **렌더 파이프라인:** Universal Render Pipeline (URP) [cite: 1]
* **개발 도구:** Visual Studio 2022 [cite: 93]
* **성능 측정:** Unity Profiler (FPS, CPU Main Thread time, GPU Frame time) [cite: 93]
* **이미지 화질 측정:** Python (Scikit-image for PSNR, SSIM, NumPy for MSE) [cite: 93]
* **개발 언어:** C#, HLSL (Compute Shaders)

## 핵심 기능 및 구현 상세

본 프로젝트는 Unity URP 렌더링 파이프라인 내에 커스텀 Render Pass 형태로 워터마킹 기법을 구현했습니다. Post-Processing 이후의 최종 렌더 타겟에 직접 접근하여 워터마크 삽입 연산을 수행합니다[cite: 96].

### 1. LSB (Least Significant Bit) 워터마킹

* 최종 렌더 텍스처의 픽셀 컬러 채널(R, G, B) 중 Blue 채널의 최하위 비트를 미리 정해진 워터마크 비트 시퀀스로 대체하는 방식으로 구현되었습니다[cite: 98].
* **특징:** 구현이 단순하고 계산 효율성이 높습니다[cite: 39]. 비가시성이 뛰어나지만, 이미지 압축, 필터링, 노이즈 삽입 등 픽셀 값에 변화를 주는 공격에 매우 취약합니다[cite: 35, 39].

### 2. DCT (Discrete Cosine Transform) + Spread Spectrum 워터마킹

* 최종 렌더 텍스처 이미지를 8x8 크기의 블록으로 분할하고, 각 블록에 대해 2D DCT Type 2 변환을 적용합니다[cite: 99, 100].
* 변환된 주파수 계수 중 워터마크 삽입에 사용될 대역의 계수(AC 계수)에 비밀 키 기반의 의사 난수(PN) 시퀀스와 워터마크 신호를 결합하여 추가합니다[cite: 101, 103]. 이후 역 DCT 변환을 통해 공간 영역으로 복원합니다[cite: 102].
* **특징:** 이미지 압축 표준(예: JPEG)에 널리 사용되며, 중간 주파수 대역 활용을 통해 워터마크의 견고성을 확보합니다[cite: 54, 55]. 확산 스펙트럼 기법을 통해 견고성을 증대시킵니다[cite: 57].

### 3. DWT (Discrete Wavelet Transform) + Spread Spectrum 워터마킹

* 최종 렌더 텍스처 이미지에 대해 2D Haar 웨이블릿 변환을 적용하여 LL, LH, HL, HH 등의 부대역으로 분해합니다[cite: 105]. 본 실험에서는 8x8 블록을 사용하고, HH 부대역에만 워터마크 신호를 추가하여 계산 부하를 줄였습니다[cite: 106, 108].
* 워터마크 삽입에 사용될 상세 부대역(HH)의 계수에 비밀 키 기반 PN 시퀀스와 워터마크 신호를 결합하여 추가합니다[cite: 107]. 이후 역 DWT 변환을 통해 공간 영역으로 복원합니다[cite: 109].
* **특징:** 이미지의 공간적 지역성을 잘 반영하며, JPEG2000 압축 표준의 근간을 이룹니다[cite: 62]. 확산 스펙트럼 기법을 통해 워터마크의 견고성을 확보합니다[cite: 109].

## 설치 및 실행 방법

1.  **Unity 설치:** Unity Hub를 통해 Unity 2022.3.60f1 버전을 설치합니다.
2.  **프로젝트 클론:**
    ```bash
    git clone [프로젝트_깃허브_URL]
    cd [프로젝트_폴더_이름]
    ```
3.  **Unity 프로젝트 열기:** Unity Hub에서 클론한 프로젝트 폴더를 열어줍니다.
4.  **Scene 실행:** `Assets/Scenes/` 경로에 있는 `[테스트_씬_이름].unity` 파일을 엽니다.
5.  **성능 측정:** Unity 에디터의 `Window > Analysis > Profiler` 메뉴를 통해 Profiler 창을 열고, 재생 버튼을 눌러 성능을 측정합니다.
6.  **화질 측정:** 화질 측정을 위한 Python 스크립트(`image_quality_analyzer.py` 등)는 `Assets/Scripts/ImageQuality/` 경로에 있습니다. Unity에서 워터마킹 전/후 이미지를 저장한 후, 해당 스크립트를 사용하여 PSNR, SSIM, MSE 값을 계산합니다.

## 주요 실험 결과

### 성능 분석 (FHD 및 4K 해상도)

* **적용 빈도의 중요성:** 워터마킹 적용 빈도가 증가할수록(즉, 1초 동안 워터마킹이 활성화되는 시간이 길어질수록) CPU Main Thread 및 GPU Frame 시간은 증가하고, 평균 FPS는 선형적으로 감소합니다[cite: 150]. 이는 실시간 렌더링 성능에 직접적인 부하를 가함을 의미합니다[cite: 151].
* **간헐적 적용의 효과:** 초당 0.02초 간격의 간헐적 적용은 Baseline (워터마킹 미적용 상태) 대비 매우 미미하거나 낮은 수준의 오버헤드를 보였습니다[cite: 153].
    * **FHD (1920x1080):** LSB 0.08ms, DCT (Coeff 63) 0.09ms, DWT (Coeff 16) 0.08ms의 짧은 오버헤드[cite: 154].
    * **4K (3840x2160):** LSB 0.01ms 이하, DCT (Coeff 16) 0.02ms, DWT 0.02ms의 오버헤드[cite: 156].
    * **핵심 시사점:** 워터마킹 활성화 시간이 짧을수록 실시간 렌더링 성능 저하를 최소화할 수 있습니다[cite: 158].
* **매 프레임 적용의 한계:** 매 프레임 워터마킹 함수를 호출하는 경우, CPU 및 GPU 처리 속도가 급격히 느려지고 평균 FPS가 유의미하게 감소하는 현상을 관찰했습니다[cite: 159].
* **기법별 성능:** LSB가 가장 낮은 성능 부하를 보였으며, 다음으로 DWT, DCT 순이었습니다[cite: 161, 162].
* **해상도 영향:** 4K 해상도에서는 동일 'Active Time'에서도 FHD 대비 더 높은 CPU/GPU 시간 및 낮은 FPS 값을 보였습니다[cite: 163, 164].

### 이미지 화질 분석 (PSNR, SSIM, MSE)

* **워터마킹 강도의 영향:** LSB를 제외한 모든 기법에서 워터마킹 강도가 증가할수록 PSNR 및 SSIM 값은 감소하고 MSE 값은 증가하여 화질이 저하됨을 확인했습니다[cite: 179].
* **확산 스펙트럼 계수의 영향:** 확산 스펙트럼 계수가 증가할수록 같은 워터마킹 강도에서도 훨씬 화질이 저하됩니다[cite: 180].
* **LSB 화질:** PSNR 48.23 dB, SSIM 0.9989로 비교적 높은 화질을 유지했습니다[cite: 182]. 하지만 공간 영역 기법 특성상 압축 공격에 취약하다는 한계가 있습니다[cite: 183].
* **DCT 및 DWT의 화질 vs. 강도 트레이드오프:** 워터마크의 견고성을 높이거나 더 많은 정보를 삽입하기 위해 강도를 높이거나 계수 개수를 늘리면 이미지 품질이 저하됩니다[cite: 185]. 하지만 강도 조절 및 계수 선택을 통해 비가시성과 견고성 간의 균형을 보다 유연하게 조절할 수 있습니다[cite: 186].
    * PSNR 40dB 이상, SSIM 0.95 이상을 유지하기 위한 최소 강도 및 계수 조건이 존재함을 확인했습니다[cite: 187, 188, 190, 191].

## 한계점 및 향후 연구

* **간단한 테스트 씬:** 본 연구는 워터마킹 연산 자체의 순수 성능 부하 측정을 위해 의도적으로 간단한 오브젝트와 기본적인 렌더링 설정으로 구성된 테스트 씬에서 진행되었습니다[cite: 199]. 실제 상용 게임 환경에서는 측정된 성능 지표와 다소 차이가 발생할 수 있으며, 향후 다양한 환경에서의 추가 검증이 필요합니다[cite: 200].
* **견고성 분석 부재:** 본 연구는 워터마크의 삽입 빈도 및 강도에 따른 성능과 화질 분석에 초점을 맞췄으며, **삽입된 워터마크가 다양한 공격(압축, 필터링, 노이즈 등)에 얼마나 견고한지에 대한 평가는 수행하지 않았습니다.** 이는 실질적인 콘텐츠 보호 기술로서 워터마킹의 효용성을 평가하는 데 있어 가장 중요한 요소이므로, 향후 연구에서 반드시 다루어져야 할 부분입니다.
* **향후 연구 방향:**
    * 다양한 게임 콘텐츠 시나리오에서의 추가 실험.
    * 다른 변환 영역 기법(예: SVD, DCT-DWT 혼합 기법) 및 상업용 솔루션과의 비교.
    * 지각적 비가시성을 고려한 적응적 워터마킹 강도 조절 방안.
    * **다양한 공격에 대한 워터마크 견고성 분석.**

## 기여 (Contributors)

* 남시영 ([Si-young Nam](mailto:si.nam@hongik.ac.kr))
* 우재영 ([Jae-Yeong Woo](mailto:jae.woo@hongik.ac.kr))
* 박정민 ([Jung-Min Park](mailto:jung.park@hongik.ac.kr))
* 김혜영 ([Hye-Young Kim](mailto:hykim@hongik.ac.kr)) - Corresponding Author

## 라이선스

본 프로젝트의 코드는 **Creative Commons Attribution Non-Commercial 3.0 (CC BY-NC 3.0)** 라이선스에 따라 배포됩니다. 이는 비상업적인 용도로는 자유로운 사용, 배포, 복제, 그리고 2차적 저작물 작성을 허용하며, 원저작자(본 연구진)를 적절히 인용해야 합니다. [cite: 10]

* **라이선스 전문 보기:** [http://creativecommons.org/licenses/by-nc/3.0/](http://creativecommons.org/licenses/by-nc/3.0/)
